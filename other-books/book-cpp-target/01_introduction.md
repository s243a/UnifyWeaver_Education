# Chapter 1: Introduction to the C++ Target

The C++ target generates modern C++ programs using nlohmann/json for JSON handling and STL containers for data manipulation.

## Why C++?

- **Modern features**: std::optional, auto, lambdas
- **Type safety**: Strong typing with templates
- **Header-only JSON**: nlohmann/json requires no linking
- **STL integration**: Familiar containers and algorithms

## Architecture Overview

```
┌─────────────────┐    ┌──────────────┐    ┌───────────────────┐
│ Prolog Predicate│───▶│cpp_target.pl │───▶│ Generated C++ Code│
└─────────────────┘    └──────────────┘    └───────────────────┘
                                                    │
                                                    ▼
                                           ┌───────────────────┐
                                           │ CMake + g++/clang │
                                           └───────────────────┘
                                                    │
                                                    ▼
                                           ┌───────────────────┐
                                           │ Native Binary     │
                                           └───────────────────┘
```

## Modes

| Mode | Use Case | Return Type |
|------|----------|-------------|
| Simple | Basic predicates | void |
| Pipeline | Stream processing | std::optional<json> |
| Generator | Multiple outputs | std::vector<json> |

## Your First C++ Program

```prolog
% Load the target
?- use_module('src/unifyweaver/targets/cpp_target').

% Generate C++ code
?- compile_predicate_to_cpp(hello/0, [], Code), 
   write_cpp_program(Code, 'hello.cpp').
```

Generated code:
```cpp
// Generated by UnifyWeaver C++ Target
// Predicate: hello/0

#include <iostream>

int main() {
    std::cout << "Hello from hello" << std::endl;
    return 0;
}
```

Compile and run:
```bash
g++ -std=c++17 -o hello hello.cpp
./hello
# Output: Hello from hello
```

## CMake Integration

For projects using nlohmann/json, UnifyWeaver generates CMake files with FetchContent:

```prolog
?- generate_cmake_cpp([project_name('MyProject')], CMake).
```

This automatically downloads nlohmann/json during the build.

## Next Steps

- [Chapter 2: Pipeline Mode](02_pipeline_mode.md) - Filtering with std::optional
